<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Draftly ‚Äî Superliga Manager</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;600;700;800;900&family=Barlow:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #080f1a;
  --bg2: #0d1829;
  --glass: rgba(255,255,255,0.06);
  --glass-md: rgba(255,255,255,0.09);
  --glass-hover: rgba(255,255,255,0.12);
  --border: rgba(255,255,255,0.1);
  --blue: #3b82f6;
  --teal: #14b8a6;
  --purple: #8b5cf6;
  --gold: #f59e0b;
  --red: #ef4444;
  --green: #22c55e;
  --text: #f0f4ff;
  --text-soft: rgba(240,244,255,0.65);
  --text-muted: rgba(240,244,255,0.35);
  --font-display: 'Barlow Condensed', sans-serif;
  --font-body: 'Barlow', sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;color:var(--text);font-family:var(--font-body);}
body{
  background:
    radial-gradient(ellipse at 75% 55%,rgba(40,80,200,0.40) 0%,transparent 50%),
    radial-gradient(ellipse at 15% 25%,rgba(100,50,160,0.30) 0%,transparent 45%),
    radial-gradient(ellipse at 50% 100%,rgba(10,40,100,0.5) 0%,transparent 55%),
    linear-gradient(150deg,#1a2240 0%,#141e38 45%,#0e1628 100%);
  background-attachment:fixed;
}
/* Fixed orbs ‚Äî only show in app, hidden on landing */
.app-orb{position:fixed;border-radius:50%;filter:blur(90px);z-index:0;pointer-events:none;}
.app-orb-1{width:600px;height:600px;background:rgba(90,180,255,0.09);top:-150px;right:-100px;}
.app-orb-2{width:450px;height:450px;background:rgba(180,130,250,0.09);bottom:-100px;left:-80px;}
.app-orb-3{width:350px;height:350px;background:rgba(61,221,200,0.06);top:35%;left:35%;}

/* ‚îÄ‚îÄ UTILS ‚îÄ‚îÄ */
.hidden{display:none!important;}
.glass{background:var(--glass);border:1px solid var(--border);border-radius:16px;backdrop-filter:blur(20px);}
.glass-md{background:var(--glass-md);border:1px solid var(--border);border-radius:16px;backdrop-filter:blur(20px);}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 20px;border-radius:10px;border:none;font-family:var(--font-body);font-size:14px;font-weight:600;cursor:pointer;transition:all .15s;}
.btn-primary{background:linear-gradient(135deg,var(--blue),var(--teal));color:#fff;box-shadow:0 4px 16px rgba(59,130,246,0.3);}
.btn-primary:hover{box-shadow:0 6px 24px rgba(59,130,246,0.45);transform:translateY(-1px);}
.btn-ghost{background:var(--glass);border:1px solid var(--border);color:var(--text-soft);}
.btn-ghost:hover{background:var(--glass-hover);color:var(--text);}
.btn-danger{background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.3);color:#ef4444;}
.btn-danger:hover{background:rgba(239,68,68,0.25);}

/* ‚îÄ‚îÄ AUTH MODAL ‚îÄ‚îÄ */
.auth-logo{display:flex;align-items:center;gap:12px;margin-bottom:28px;}
.auth-logo-mark{width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,var(--blue),var(--teal));display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-size:20px;font-weight:900;color:#fff;box-shadow:0 4px 16px rgba(59,130,246,0.4);}
.auth-logo-text{font-family:var(--font-display);font-size:28px;font-weight:800;letter-spacing:1px;}
.auth-logo-text span{color:var(--teal);}
.auth-tabs{display:flex;gap:4px;background:rgba(0,0,0,0.3);border-radius:10px;padding:4px;margin-bottom:24px;}
.auth-tab{flex:1;padding:8px;border-radius:7px;border:none;background:none;color:rgba(240,244,255,0.4);font-family:var(--font-body);font-size:14px;font-weight:600;cursor:pointer;transition:all .15s;}
.auth-tab.active{background:rgba(255,255,255,0.09);color:var(--text);border:1px solid rgba(255,255,255,0.1);}
.form-group{margin-bottom:16px;}
.form-group label{display:block;font-size:12px;font-weight:600;color:rgba(240,244,255,0.35);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px;}
.form-group input{width:100%;padding:11px 14px;background:rgba(0,0,0,0.3);border:1px solid rgba(255,255,255,0.1);border-radius:10px;color:var(--text);font-family:var(--font-body);font-size:14px;transition:border-color .15s;}
.form-group input:focus{outline:none;border-color:var(--blue);}
.form-group input::placeholder{color:rgba(240,244,255,0.25);}
.auth-error{background:rgba(239,68,68,0.12);border:1px solid rgba(239,68,68,0.3);border-radius:10px;padding:10px 14px;font-size:13px;color:#fca5a5;margin-bottom:16px;}
.auth-success{background:rgba(34,197,94,0.12);border:1px solid rgba(34,197,94,0.3);border-radius:10px;padding:10px 14px;font-size:13px;color:#86efac;margin-bottom:16px;}

/* ‚îÄ‚îÄ APP LAYOUT ‚îÄ‚îÄ */
#app{display:flex;flex-direction:column;min-height:100vh;position:relative;z-index:1;}
.app-topbar{
  position:sticky;top:0;z-index:100;
  display:flex;align-items:center;height:60px;
  background:rgba(14,22,40,0.72);
  backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);
  border-bottom:1px solid rgba(255,255,255,0.1);
  padding:0 24px;
}
.app-logo{display:flex;align-items:center;gap:9px;flex-shrink:0;margin-right:auto;cursor:pointer;}
.app-logo-mark{width:34px;height:34px;border-radius:10px;background:linear-gradient(135deg,var(--blue),var(--teal));display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-size:16px;font-weight:900;color:#fff;box-shadow:0 4px 14px rgba(59,130,246,0.35);}
.app-logo-text{font-family:var(--font-display);font-size:20px;font-weight:800;letter-spacing:.5px;color:#fff;}
.app-logo-text span{color:var(--teal);}
.app-topbar-right{display:flex;align-items:center;gap:10px;flex-shrink:0;}
.app-chip{display:flex;align-items:center;gap:6px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.13);border-radius:20px;padding:5px 14px;font-size:12.5px;font-weight:600;color:rgba(255,255,255,0.6);white-space:nowrap;cursor:default;}
.app-chip .v{color:#fff;font-weight:700;}
.app-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,var(--blue),var(--purple));border:2px solid rgba(255,255,255,0.2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-size:13px;font-weight:700;color:#fff;transition:transform .15s;}
.app-avatar:hover{transform:scale(1.08);}

/* ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ */
.main{flex:1;padding:0 20px 60px;}
.app-inner{max-width:1060px;margin:0 auto;}
.page{display:none;padding-top:28px;flex-direction:column;gap:20px;}
.page.active{display:flex;animation:fadeIn .25s ease;}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
.page-header{margin-bottom:24px;}
.page-title{font-family:var(--font-display);font-size:32px;font-weight:800;letter-spacing:.5px;}
.page-sub{font-size:14px;color:var(--text-soft);margin-top:4px;}

/* ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ */
.stat-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:20px;}
.stat-card{padding:18px;text-align:center;}
.stat-val{font-family:var(--font-display);font-size:36px;font-weight:900;line-height:1;}
.stat-lbl{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.8px;color:var(--text-muted);margin-top:4px;}
.stat-card.blue .stat-val{color:var(--blue);}
.stat-card.teal .stat-val{color:var(--teal);}
.stat-card.gold .stat-val{color:var(--gold);}
.stat-card.purple .stat-val{color:var(--purple);}
.two-col{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
.card-title{font-family:var(--font-display);font-size:16px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:14px;color:var(--text-soft);}

/* ‚îÄ‚îÄ PITCH ‚îÄ‚îÄ */
.pitch-wrap{border-radius:14px;position:relative;overflow:hidden;aspect-ratio:5/6;background:radial-gradient(ellipse at 50% 50%,rgba(22,90,50,0.95),rgba(6,24,14,1));border:1px solid rgba(255,255,255,0.07);}
.pitch-wrap svg.field{position:absolute;inset:0;width:100%;height:100%;}
.pd{position:absolute;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;z-index:2;cursor:default;}
.p-badge{width:46px;height:46px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-size:11px;font-weight:900;letter-spacing:.5px;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);position:relative;transition:transform .15s;}
.p-badge:hover{transform:scale(1.1);}
.p-badge-abbr{line-height:1;}
.chip-cap{position:absolute;top:-4px;right:-4px;width:16px;height:16px;border-radius:50%;background:var(--gold);display:flex;align-items:center;justify-content:center;font-size:8px;font-weight:900;color:#000;border:2px solid rgba(8,16,28,.8);z-index:2;}
.pd-name{font-size:10px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);backdrop-filter:blur(6px);padding:2px 8px;border-radius:20px;border:1px solid rgba(255,255,255,0.18);}
.pd-pts{font-size:9px;font-weight:700;color:var(--teal);white-space:nowrap;}

/* ‚îÄ‚îÄ BYG HOLD ‚îÄ‚îÄ */
.byg-layout{display:grid;grid-template-columns:1fr 300px;gap:16px;align-items:start;}
.pool-header{display:flex;align-items:center;gap:8px;margin-bottom:12px;flex-wrap:wrap;}
.pool-search{flex:1;min-width:120px;padding:8px 12px;background:rgba(0,0,0,0.3);border:1px solid var(--border);border-radius:9px;color:var(--text);font-size:13px;font-family:var(--font-body);}
.pool-search:focus{outline:none;border-color:var(--blue);}
.pos-btns{display:flex;gap:4px;}
.pos-btn{padding:5px 10px;border-radius:7px;border:1px solid var(--border);background:var(--glass);color:var(--text-muted);font-size:12px;font-weight:700;cursor:pointer;transition:all .12s;}
.pos-btn.active{background:rgba(59,130,246,0.2);border-color:var(--blue);color:var(--text);}
.pool-list{display:flex;flex-direction:column;gap:4px;max-height:500px;overflow-y:auto;}
.pool-row{display:flex;align-items:center;gap:10px;padding:9px 10px;border-radius:10px;cursor:pointer;transition:background .12s;border:1px solid transparent;}
.pool-row:hover{background:var(--glass-hover);}
.pool-row.in-team{opacity:.3;pointer-events:none;}
.pool-row.cant-afford{opacity:.4;pointer-events:none;}
.pool-row.wrong-pos{opacity:.25;pointer-events:none;}
.pool-row.selected-slot{border-color:var(--blue);background:rgba(59,130,246,0.1);}
.pr-badge{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-size:9px;font-weight:900;flex-shrink:0;border:1.5px solid rgba(255,255,255,0.2);}
.pr-info{flex:1;}
.pr-name{font-size:13px;font-weight:600;}
.pr-club{font-size:11px;color:var(--text-muted);}
.pr-pos{font-size:11px;font-weight:700;}
.pr-price{font-size:12px;font-weight:700;color:var(--teal);white-space:nowrap;}
.pr-pts{font-size:11px;font-weight:700;color:var(--text-muted);}
.slot-hint{font-size:12px;color:var(--text-muted);padding:10px;text-align:center;border:1px dashed var(--border);border-radius:10px;margin-bottom:10px;}
.slot-hint.selecting{border-color:var(--blue);color:var(--blue);background:rgba(59,130,246,0.06);}

/* ‚îÄ‚îÄ RANGLISTE ‚îÄ‚îÄ */
.lb-row{display:flex;align-items:center;gap:12px;padding:12px 14px;border-radius:12px;margin-bottom:6px;background:var(--glass);border:1px solid transparent;transition:background .12s;}
.lb-row:hover{background:var(--glass-hover);}
.lb-row.me{border-color:var(--blue);background:rgba(59,130,246,0.08);}
.lb-rank{font-family:var(--font-display);font-size:20px;font-weight:900;width:36px;text-align:center;color:var(--text-muted);}
.lb-rank.top3{color:var(--gold);}
.lb-info{flex:1;}
.lb-name{font-size:14px;font-weight:600;}
.lb-team{font-size:12px;color:var(--text-muted);}
.lb-pts{font-family:var(--font-display);font-size:22px;font-weight:800;color:var(--teal);}

/* ‚îÄ‚îÄ LIGAER ‚îÄ‚îÄ */
.league-card{padding:16px 18px;margin-bottom:10px;display:flex;align-items:center;gap:14px;}
.league-icon{width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,rgba(59,130,246,0.3),rgba(139,92,246,0.3));display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;}
.league-info{flex:1;}
.league-name{font-size:15px;font-weight:700;}
.league-meta{font-size:12px;color:var(--text-muted);}
.league-rank{font-family:var(--font-display);font-size:24px;font-weight:900;color:var(--gold);}
.code-display{background:rgba(0,0,0,0.4);border:1px solid var(--border);border-radius:10px;padding:10px 14px;font-family:monospace;font-size:16px;font-weight:700;letter-spacing:3px;color:var(--teal);text-align:center;cursor:pointer;user-select:all;}
.two-actions{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px;}

/* ‚îÄ‚îÄ BUDGET ‚îÄ‚îÄ */
.budget-bar-wrap{background:rgba(0,0,0,0.3);border-radius:6px;height:6px;overflow:hidden;margin:8px 0;}
.budget-bar-fill{height:100%;border-radius:6px;background:linear-gradient(90deg,var(--teal),var(--blue));transition:width .3s;}
.budget-nums{display:flex;justify-content:space-between;font-size:12px;color:var(--text-muted);}
.budget-nums span:last-child{color:var(--teal);font-weight:600;}

/* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
#toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(80px);background:rgba(20,30,50,0.95);border:1px solid var(--border);border-radius:12px;padding:12px 20px;font-size:14px;font-weight:500;z-index:999;transition:transform .25s;pointer-events:none;backdrop-filter:blur(20px);}
#toast.show{transform:translateX(-50%) translateY(0);}
#toast.success{border-color:rgba(34,197,94,0.4);color:#86efac;}
#toast.error{border-color:rgba(239,68,68,0.4);color:#fca5a5;}

/* ‚îÄ‚îÄ LOADING ‚îÄ‚îÄ */
.spinner{width:32px;height:32px;border:3px solid var(--border);border-top-color:var(--blue);border-radius:50%;animation:spin .7s linear infinite;margin:40px auto;}
@keyframes spin{to{transform:rotate(360deg);}}
.loading-screen{display:flex;align-items:center;justify-content:center;height:100%;flex-direction:column;gap:16px;}
.loading-logo{font-family:var(--font-display);font-size:40px;font-weight:900;background:linear-gradient(135deg,var(--blue),var(--teal));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}

/* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
@media(max-width:768px){
  .sidebar{display:none;}
  .stat-grid{grid-template-columns:repeat(2,1fr);}
  .two-col{grid-template-columns:1fr;}
  .byg-layout{grid-template-columns:1fr;}
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   LANDING PAGE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#landing{min-height:100vh;display:flex;flex-direction:column;overflow-x:hidden;}

/* Nav */
.lp-nav{display:flex;align-items:center;justify-content:space-between;padding:20px 40px;position:fixed;top:0;left:0;right:0;z-index:50;background:rgba(8,15,26,0.7);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,255,255,0.06);}
.lp-nav-logo{display:flex;align-items:center;gap:10px;text-decoration:none;}
.lp-nav-logo-mark{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--blue),var(--teal));display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-size:17px;font-weight:900;color:#fff;box-shadow:0 0 20px rgba(59,130,246,0.4);}
.lp-nav-logo-text{font-family:var(--font-display);font-size:24px;font-weight:800;letter-spacing:1px;color:var(--text);}
.lp-nav-logo-text span{color:var(--teal);}
.lp-nav-actions{display:flex;align-items:center;gap:10px;}

/* Hero */
.lp-hero{min-height:100vh;display:flex;align-items:center;padding:120px 40px 80px;position:relative;overflow:hidden;}
.lp-hero-bg{position:absolute;inset:0;pointer-events:none;}
.lp-hero-orb1{position:absolute;top:-200px;left:-200px;width:700px;height:700px;border-radius:50%;background:radial-gradient(circle,rgba(59,130,246,0.15) 0%,transparent 70%);animation:orbFloat 8s ease-in-out infinite;}
.lp-hero-orb2{position:absolute;bottom:-300px;right:-200px;width:800px;height:800px;border-radius:50%;background:radial-gradient(circle,rgba(20,184,166,0.1) 0%,transparent 70%);animation:orbFloat 10s ease-in-out infinite reverse;}
.lp-hero-orb3{position:absolute;top:40%;left:40%;width:400px;height:400px;border-radius:50%;background:radial-gradient(circle,rgba(139,92,246,0.08) 0%,transparent 70%);animation:orbFloat 12s ease-in-out infinite 2s;}
@keyframes orbFloat{0%,100%{transform:translate(0,0);}50%{transform:translate(30px,20px);}}

.lp-hero-grid{display:grid;grid-template-columns:1fr 1fr;gap:60px;align-items:center;max-width:1200px;margin:0 auto;width:100%;position:relative;z-index:2;}
.lp-hero-badge{display:inline-flex;align-items:center;gap:8px;background:rgba(59,130,246,0.12);border:1px solid rgba(59,130,246,0.3);border-radius:20px;padding:6px 14px;font-size:12px;font-weight:700;color:var(--blue);text-transform:uppercase;letter-spacing:1px;margin-bottom:20px;}
.lp-hero-badge::before{content:'';width:7px;height:7px;border-radius:50%;background:var(--blue);animation:pulse 2s ease infinite;}
@keyframes pulse{0%,100%{opacity:1;}50%{opacity:.4;}}
.lp-hero-title{font-family:var(--font-display);font-size:72px;font-weight:900;line-height:.95;letter-spacing:-1px;margin-bottom:20px;}
.lp-hero-title span{background:linear-gradient(135deg,var(--blue),var(--teal));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.lp-hero-sub{font-size:18px;color:var(--text-soft);line-height:1.6;margin-bottom:36px;max-width:460px;}
.lp-hero-ctas{display:flex;gap:12px;flex-wrap:wrap;}
.btn-hero{padding:14px 28px;font-size:16px;font-weight:700;border-radius:12px;}
.lp-hero-stats{display:flex;gap:28px;margin-top:36px;}
.lp-hero-stat{text-align:center;}
.lp-hero-stat-val{font-family:var(--font-display);font-size:28px;font-weight:900;background:linear-gradient(135deg,var(--blue),var(--teal));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.lp-hero-stat-lbl{font-size:11px;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:.8px;}

/* Pitch preview */
.lp-pitch-preview{position:relative;padding-top:28px;}
.lp-pitch-preview-inner{border-radius:20px;overflow:hidden;position:relative;aspect-ratio:5/6;background:radial-gradient(ellipse at 50% 50%,rgba(22,90,50,0.95),rgba(6,24,14,1));border:1px solid rgba(255,255,255,0.1);box-shadow:0 40px 80px rgba(0,0,0,0.6),0 0 0 1px rgba(255,255,255,0.05),inset 0 1px 0 rgba(255,255,255,0.1);animation:pitchFloat 6s ease-in-out infinite;}
@keyframes pitchFloat{0%,100%{transform:translateY(0) rotateX(0deg);}50%{transform:translateY(-12px) rotateX(2deg);}}
.lp-pitch-glow{position:absolute;inset:-2px;border-radius:22px;background:linear-gradient(135deg,rgba(59,130,246,0.3),rgba(20,184,166,0.2));z-index:-1;filter:blur(20px);}
.lp-pitch-pill{position:absolute;top:-16px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,var(--blue),var(--teal));border-radius:20px;padding:6px 16px;font-family:var(--font-display);font-size:13px;font-weight:800;letter-spacing:.5px;white-space:nowrap;box-shadow:0 4px 16px rgba(59,130,246,0.4);}

/* Features */
.lp-features{padding:100px 40px;max-width:1200px;margin:0 auto;width:100%;}
.lp-section-label{text-align:center;font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:2px;color:var(--teal);margin-bottom:12px;}
.lp-section-title{text-align:center;font-family:var(--font-display);font-size:48px;font-weight:900;margin-bottom:16px;}
.lp-section-sub{text-align:center;font-size:16px;color:var(--text-soft);margin-bottom:60px;max-width:540px;margin-left:auto;margin-right:auto;}
.features-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;}
.feature-card{padding:28px;border-radius:20px;background:var(--glass);border:1px solid var(--border);transition:all .2s;position:relative;overflow:hidden;}
.feature-card::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,transparent,rgba(255,255,255,0.02));pointer-events:none;}
.feature-card:hover{background:var(--glass-md);transform:translateY(-4px);box-shadow:0 20px 40px rgba(0,0,0,0.3);}
.feature-icon{width:52px;height:52px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:24px;margin-bottom:16px;}
.feature-icon.blue{background:rgba(59,130,246,0.15);border:1px solid rgba(59,130,246,0.25);}
.feature-icon.teal{background:rgba(20,184,166,0.15);border:1px solid rgba(20,184,166,0.25);}
.feature-icon.gold{background:rgba(245,158,11,0.15);border:1px solid rgba(245,158,11,0.25);}
.feature-icon.purple{background:rgba(139,92,246,0.15);border:1px solid rgba(139,92,246,0.25);}
.feature-icon.red{background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.25);}
.feature-icon.green{background:rgba(34,197,94,0.15);border:1px solid rgba(34,197,94,0.25);}
.feature-title{font-family:var(--font-display);font-size:20px;font-weight:800;margin-bottom:8px;letter-spacing:.3px;}
.feature-desc{font-size:14px;color:var(--text-soft);line-height:1.6;}

/* How it works */
.lp-how{padding:80px 40px;background:rgba(255,255,255,0.02);border-top:1px solid var(--border);border-bottom:1px solid var(--border);}
.lp-how-inner{max-width:1000px;margin:0 auto;}
.steps-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:32px;margin-top:60px;}
.step{text-align:center;position:relative;}
.step::after{content:'‚Üí';position:absolute;top:32px;right:-16px;font-size:24px;color:var(--text-muted);display:block;}
.step:last-child::after{display:none;}
.step-num{width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,var(--blue),var(--teal));display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-size:28px;font-weight:900;margin:0 auto 16px;box-shadow:0 8px 24px rgba(59,130,246,0.3);}
.step-title{font-family:var(--font-display);font-size:20px;font-weight:800;margin-bottom:8px;}
.step-desc{font-size:14px;color:var(--text-soft);line-height:1.6;}

/* CTA section */
.lp-cta{padding:100px 40px;text-align:center;position:relative;overflow:hidden;}
.lp-cta-inner{max-width:600px;margin:0 auto;position:relative;z-index:2;}
.lp-cta-title{font-family:var(--font-display);font-size:56px;font-weight:900;line-height:1;margin-bottom:16px;}
.lp-cta-title span{background:linear-gradient(135deg,var(--blue),var(--teal));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.lp-cta-sub{font-size:16px;color:var(--text-soft);margin-bottom:36px;}
.lp-cta-bg{position:absolute;inset:0;background:radial-gradient(ellipse at 50% 50%,rgba(59,130,246,0.1),transparent 70%);pointer-events:none;}

/* Footer */
.lp-footer{padding:24px 40px;border-top:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
.lp-footer-logo{font-family:var(--font-display);font-size:18px;font-weight:800;letter-spacing:1px;}
.lp-footer-logo span{color:var(--teal);}
.lp-footer-copy{font-size:12px;color:var(--text-muted);}

/* Signup modal */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(8px);z-index:200;display:flex;align-items:center;justify-content:center;padding:20px;opacity:0;pointer-events:none;transition:opacity .2s;}
.modal-overlay.open{opacity:1;pointer-events:all;}
.modal-card{width:100%;max-width:420px;padding:36px;background:rgba(13,24,41,0.98);border:1px solid var(--border);border-radius:24px;transform:scale(.95) translateY(20px);transition:transform .2s;box-shadow:0 40px 80px rgba(0,0,0,0.6);}
.modal-overlay.open .modal-card{transform:scale(1) translateY(0);}
.modal-close{position:absolute;top:16px;right:16px;width:32px;height:32px;border-radius:50%;background:var(--glass);border:1px solid var(--border);color:var(--text-muted);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px;transition:all .12s;}
.modal-close:hover{background:var(--glass-hover);color:var(--text);}

/* ‚îÄ‚îÄ DASHBOARD RICH UI ‚îÄ‚îÄ */
.dash-team-header{display:flex;align-items:flex-start;justify-content:space-between;gap:16px;flex-wrap:wrap;margin-bottom:16px;}
.dash-team-name{font-family:var(--font-display);font-size:30px;font-weight:800;letter-spacing:-.5px;line-height:1;}
.dash-team-sub{font-size:13px;color:var(--text-muted);font-weight:500;}
.dash-deadline-tag{display:inline-flex;align-items:center;gap:7px;background:var(--glass);border:1px solid var(--border);border-radius:20px;padding:6px 14px;font-size:12px;font-weight:600;color:var(--text-soft);align-self:flex-start;margin-top:6px;}
.live-dot{width:7px;height:7px;border-radius:50%;background:var(--teal);box-shadow:0 0 8px var(--teal);flex-shrink:0;}
.dash-tiles{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-bottom:20px;}
.dash-tile{border-radius:18px;padding:22px 14px 18px;display:flex;flex-direction:column;align-items:center;gap:10px;cursor:pointer;border:1px solid rgba(255,255,255,0.13);backdrop-filter:blur(12px);transition:transform .18s ease,border-color .18s,box-shadow .18s;min-height:120px;text-align:center;}
.dash-tile:hover{transform:translateY(-4px);border-color:rgba(255,255,255,0.25);box-shadow:0 16px 40px rgba(0,0,0,0.25);}
.dash-tile-ico{width:44px;height:44px;flex-shrink:0;}
.dash-tile-ico svg{width:44px;height:44px;}
.dash-tile-lbl{font-size:12px;font-weight:700;color:var(--text);letter-spacing:.3px;text-transform:uppercase;}
.dash-tile-sub{font-size:10.5px;color:rgba(255,255,255,0.5);line-height:1.3;}
.dt-blue{background:linear-gradient(145deg,rgba(59,130,246,0.42),rgba(37,99,235,0.28));}
.dt-teal{background:linear-gradient(145deg,rgba(20,184,166,0.42),rgba(13,148,136,0.28));}
.dt-purple{background:linear-gradient(145deg,rgba(139,92,246,0.42),rgba(109,40,217,0.28));}
.dt-pink{background:linear-gradient(145deg,rgba(236,72,153,0.42),rgba(190,24,93,0.28));}
.dt-orange{background:linear-gradient(145deg,rgba(249,115,22,0.42),rgba(194,65,12,0.28));}
.dash-main-grid{display:grid;grid-template-columns:1fr 310px;gap:16px;align-items:start;}
.dash-pitch-card{background:var(--glass);backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:20px;padding:16px;display:flex;flex-direction:column;gap:12px;}
.dash-card-hdr{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px;}
.dash-card-title{font-size:14px;font-weight:700;color:var(--text);}
.dash-right-col{display:flex;flex-direction:column;gap:14px;}
.dash-glass-card{background:var(--glass-md);backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:18px;padding:18px;}
.dash-gc-title{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1.4px;color:var(--text-muted);margin-bottom:14px;}
.dash-rank-big{text-align:center;padding:8px 0 14px;}
.dash-rank-num{font-family:var(--font-display);font-size:44px;font-weight:800;color:var(--text);letter-spacing:-2px;line-height:1;}
.dash-rank-sub{font-size:12px;color:var(--text-muted);margin-top:4px;}
.dash-stat-rows{display:flex;flex-direction:column;}
.dash-sr{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.07);}
.dash-sr:last-child{border-bottom:none;}
.dash-sr-l{font-size:13px;color:var(--text-soft);font-weight:500;}
.dash-sr-v{font-size:13px;font-weight:700;color:var(--text);}
.dash-sr-v.up{color:var(--teal);}
.dash-mini-liga{display:flex;flex-direction:column;}
.dash-ml-row{display:flex;align-items:center;gap:8px;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.07);}
.dash-ml-row:last-child{border-bottom:none;}
.dash-ml-row.me{background:rgba(59,130,246,0.08);border-radius:8px;padding:8px;margin:0 -8px;}
.dash-ml-rank{font-size:13px;font-weight:800;color:var(--blue);width:28px;}
.dash-ml-name{flex:1;font-size:13px;color:var(--text-soft);}
.dash-ml-pts{font-size:13px;font-weight:700;color:var(--text);}
.dash-pitch{border-radius:14px;position:relative;overflow:hidden;aspect-ratio:5/6;background:radial-gradient(ellipse at 50% 50%,rgba(22,90,50,0.95) 0%,rgba(6,24,14,1) 100%);border:1px solid rgba(255,255,255,0.07);}
.dash-pitch::before{content:"";position:absolute;inset:0;z-index:0;background:radial-gradient(ellipse at 50% 50%,rgba(60,180,100,0.08) 0%,transparent 65%);pointer-events:none;}
.dash-pitch svg.field{position:absolute;inset:0;width:100%;height:100%;z-index:1;}
.dash-pd{position:absolute;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;z-index:10;}
.dash-p-badge{width:44px;height:44px;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 16px rgba(0,0,0,0.45);border:2px solid rgba(255,255,255,0.25);}
.dash-p-badge-abbr{font-size:11px;font-weight:900;letter-spacing:.5px;}
.dash-pd-name{font-size:10px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.7);backdrop-filter:blur(6px);padding:2px 7px;border-radius:20px;border:1px solid rgba(255,255,255,0.18);line-height:1.4;}
.dash-empty-badge{width:44px;height:44px;border-radius:50%;border:2px dashed rgba(255,255,255,0.2);display:flex;align-items:center;justify-content:center;opacity:.4;}
@media(max-width:900px){
  .dash-tiles{grid-template-columns:repeat(3,1fr);}
  .dash-main-grid{grid-template-columns:1fr;}
  .dash-right-col{flex-direction:row;flex-wrap:wrap;}
  .dash-glass-card{flex:1;min-width:220px;}
}
@media(max-width:600px){
  .dash-tiles{grid-template-columns:repeat(3,1fr);gap:10px;}
  .dash-tile{padding:18px 10px 14px;min-height:100px;}
  .dash-tile-sub{display:none;}
  .dash-right-col{flex-direction:column;}
}
@media(max-width:480px){
  .dash-tiles{grid-template-columns:repeat(2,1fr);}
  .dash-tiles .dash-tile:nth-child(5){grid-column:span 2;}
}

/* Responsive landing */
@media(max-width:900px){
  .lp-hero-grid{grid-template-columns:1fr;gap:40px;}
  .lp-hero-title{font-size:52px;}
  .lp-pitch-preview{max-width:340px;margin:0 auto;}
  .features-grid{grid-template-columns:1fr 1fr;}
  .steps-grid{grid-template-columns:1fr;}
  .step::after{content:'‚Üì';right:50%;transform:translateX(50%);}
  .lp-nav{padding:16px 20px;}
  .lp-hero{padding:100px 20px 60px;}
  .lp-features,.lp-cta{padding:60px 20px;}
  .lp-section-title{font-size:36px;}
}
@media(max-width:600px){
  .features-grid{grid-template-columns:1fr;}
  .lp-hero-title{font-size:44px;}
  .lp-cta-title{font-size:40px;}
  .lp-hero-stats{gap:16px;}
}
</style>
</head>
<body>

<!-- Fixed background orbs (visible when logged in) -->
<div class="app-orb app-orb-1"></div>
<div class="app-orb app-orb-2"></div>
<div class="app-orb app-orb-3"></div>

<!-- Loading -->
<div id="loading-screen" class="loading-screen">
  <div class="loading-logo">Draftly</div>
  <div class="spinner"></div>
</div>

<!-- LANDING PAGE -->
<div id="landing" class="hidden">

  <!-- Nav -->
  <nav class="lp-nav">
    <a class="lp-nav-logo" href="#">
      <div class="lp-nav-logo-mark">D</div>
      <div class="lp-nav-logo-text">Draft<span>ly</span></div>
    </a>
    <div class="lp-nav-actions">
      <button class="btn btn-ghost" onclick="openModal('login')">Log ind</button>
      <button class="btn btn-primary" onclick="openModal('register')">Opret gratis konto</button>
    </div>
  </nav>

  <!-- Hero -->
  <section class="lp-hero">
    <div class="lp-hero-bg">
      <div class="lp-hero-orb1"></div>
      <div class="lp-hero-orb2"></div>
      <div class="lp-hero-orb3"></div>
    </div>
    <div class="lp-hero-grid">
      <div>
        <div class="lp-hero-badge">üèÜ S√¶son 2025/26 er i gang</div>
        <h1 class="lp-hero-title">Byg dit<br><span>dr√∏mmehold</span><br>i Superligaen</h1>
        <p class="lp-hero-sub">V√¶lg spillere fra alle 14 Superliga-klubber, tjen point baseret p√• rigtige kampe og udfordre dine venner i private miniligaer.</p>
        <div class="lp-hero-ctas">
          <button class="btn btn-primary btn-hero" onclick="openModal('register')">üöÄ Kom i gang ‚Äî det er gratis</button>
          <button class="btn btn-ghost btn-hero" onclick="openModal('login')">Log ind</button>
        </div>
        <div class="lp-hero-stats">
          <div class="lp-hero-stat"><div class="lp-hero-stat-val">50M</div><div class="lp-hero-stat-lbl">Budget</div></div>
          <div class="lp-hero-stat"><div class="lp-hero-stat-val">11</div><div class="lp-hero-stat-lbl">Spillere</div></div>
          <div class="lp-hero-stat"><div class="lp-hero-stat-val">3</div><div class="lp-hero-stat-lbl">Formationer</div></div>
          <div class="lp-hero-stat"><div class="lp-hero-stat-val">‚àû</div><div class="lp-hero-stat-lbl">Miniligaer</div></div>
        </div>
      </div>
      <div class="lp-pitch-preview">
        <div class="lp-pitch-glow"></div>
        <div class="lp-pitch-pill">‚öΩ S√¶son 2025/26</div>
        <div class="lp-pitch-preview-inner">
          <svg style="position:absolute;inset:0;width:100%;height:100%;" viewBox="0 0 500 580" preserveAspectRatio="xMidYMid slice">
            <defs><pattern id="lp-sf" x="0" y="0" width="500" height="72" patternUnits="userSpaceOnUse"><rect width="500" height="36" fill="rgba(22,90,50,0.55)"/><rect y="36" width="500" height="36" fill="rgba(16,72,40,0.55)"/></pattern></defs>
            <rect width="500" height="580" fill="url(#lp-sf)"/>
            <rect x="18" y="14" width="464" height="552" fill="none" stroke="rgba(255,255,255,0.25)" stroke-width="1.5" rx="2"/>
            <line x1="18" y1="290" x2="482" y2="290" stroke="rgba(255,255,255,0.25)" stroke-width="1.5"/>
            <circle cx="250" cy="290" r="58" fill="none" stroke="rgba(255,255,255,0.22)" stroke-width="1.5"/>
            <circle cx="250" cy="290" r="4" fill="rgba(255,255,255,0.32)"/>
            <rect x="118" y="14" width="264" height="96" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
            <rect x="178" y="14" width="144" height="40" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
            <rect x="198" y="5" width="104" height="12" fill="none" stroke="rgba(255,255,255,0.28)" stroke-width="1.5"/>
            <rect x="118" y="470" width="264" height="96" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
            <rect x="178" y="526" width="144" height="40" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
            <rect x="198" y="563" width="104" height="12" fill="none" stroke="rgba(255,255,255,0.28)" stroke-width="1.5"/>
          </svg>
          <!-- Preview players -->
          <div style="position:absolute;left:50%;top:14%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#cc0e1e;color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">FCM</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">H√∂jlund</div>
          </div>
          <div style="position:absolute;left:22%;top:27%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#e8171f;color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">FCN</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">Skov Olsen</div>
          </div>
          <div style="position:absolute;left:78%;top:27%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#f5f5f5;color:#111;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">FCK</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">Falk</div>
          </div>
          <div style="position:absolute;left:34%;top:43%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#e8171f;color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">FCN</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">Kirial</div>
          </div>
          <div style="position:absolute;left:66%;top:43%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#006b3c;color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">VFF</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">Mensah</div>
          </div>
          <div style="position:absolute;left:9%;top:62%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#f6d000;color:#003a8c;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">BIF</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">Uhre</div>
          </div>
          <div style="position:absolute;left:32%;top:62%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#cc0e1e;color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">FCM</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">Fenger</div>
          </div>
          <div style="position:absolute;left:68%;top:62%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#1a3d8f;color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">AGF</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">Boysen</div>
          </div>
          <div style="position:absolute;left:91%;top:62%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#0047b0;color:#fff;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">OB</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">Levi</div>
          </div>
          <div style="position:absolute;left:50%;top:87%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;">
            <div style="width:44px;height:44px;border-radius:50%;background:#f5f5f5;color:#111;display:flex;align-items:center;justify-content:center;font-family:'Barlow Condensed',sans-serif;font-size:10px;font-weight:900;border:2px solid rgba(255,255,255,0.25);box-shadow:0 4px 12px rgba(0,0,0,0.5);">FCK</div>
            <div style="font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:rgba(0,0,0,0.75);padding:2px 8px;border-radius:20px;">R√∂nnow</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Features -->
  <section class="lp-features">
    <div class="lp-section-label">Funktioner</div>
    <h2 class="lp-section-title">Alt hvad du beh√∏ver</h2>
    <p class="lp-section-sub">Draftly giver dig de samme redskaber som de store platforms ‚Äî men med fokus p√• dansk Superliga.</p>
    <div class="features-grid">
      <div class="feature-card">
        <div class="feature-icon blue">‚öΩ</div>
        <div class="feature-title">Byg dit hold</div>
        <div class="feature-desc">V√¶lg 11 spillere fra alle Superliga-klubber inden for et budget p√• 50 mio. kr. Tre formationer at v√¶lge imellem.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon teal">üìä</div>
        <div class="feature-title">Live Point</div>
        <div class="feature-desc">Tjen point baseret p√• rigtige kampe. M√•l, assists, clean sheets, gule og r√∏de kort ‚Äî alt t√¶ller.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon gold">üèÜ</div>
        <div class="feature-title">Miniligaer</div>
        <div class="feature-desc">Opret en privat liga og invit√©r dine venner med en unik kode. Se hvem der er den bedste manager.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon purple">üí∞</div>
        <div class="feature-title">Spillerv√¶rdier</div>
        <div class="feature-desc">Spillernes priser afspejler deres form og pr√¶stationer. Hold √∏je med de billige perler f√∏r alle andre.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon red">üîÑ</div>
        <div class="feature-title">Transfervindue</div>
        <div class="feature-desc">Skift spillere mellem runerne. Tilpas dit hold til kommende kampe og udnyt formen optimalt.</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon green">üì±</div>
        <div class="feature-title">Altid med dig</div>
        <div class="feature-desc">Draftly fungerer perfekt p√• b√•de telefon og computer. F√∏lg med fra tribunen, sofaen eller baren.</div>
      </div>
    </div>
  </section>

  <!-- How it works -->
  <section class="lp-how">
    <div class="lp-how-inner">
      <div class="lp-section-label">S√•dan virker det</div>
      <h2 class="lp-section-title">Kom i gang p√• 3 minutter</h2>
      <div class="steps-grid">
        <div class="step">
          <div class="step-num">1</div>
          <div class="step-title">Opret en gratis konto</div>
          <div class="step-desc">Tilmeld dig med din e-mail p√• under et minut. Ingen kreditkort, ingen forpligtelse.</div>
        </div>
        <div class="step">
          <div class="step-num">2</div>
          <div class="step-title">Byg dit dr√∏mmehold</div>
          <div class="step-desc">V√¶lg 11 spillere inden for budgettet. Analyser statistik og find de skjulte gems.</div>
        </div>
        <div class="step">
          <div class="step-num">3</div>
          <div class="step-title">Udfordre dine venner</div>
          <div class="step-desc">Invit√©r venner til en privat miniliga og se hvem der kender Superligaen bedst.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="lp-cta">
    <div class="lp-cta-bg"></div>
    <div class="lp-cta-inner">
      <h2 class="lp-cta-title">Klar til at blive<br><span>Superliga Manager?</span></h2>
      <p class="lp-cta-sub">Tilmeld dig gratis og byg dit hold inden n√¶ste runde.</p>
      <button class="btn btn-primary btn-hero" onclick="openModal('register')">üöÄ Opret gratis konto nu</button>
    </div>
  </section>

  <!-- Footer -->
  <footer class="lp-footer">
    <div class="lp-footer-logo">Draft<span>ly</span></div>
    <div class="lp-footer-copy">¬© 2026 Draftly ¬∑ Uofficielt fan-produkt ¬∑ Ikke tilknyttet Superliga A/S</div>
  </footer>
</div>

<!-- Auth Modal -->
<div id="auth-modal" class="modal-overlay" onclick="closeModalIfBg(event)">
  <div class="modal-card" style="position:relative;">
    <button class="modal-close" onclick="closeModal()">‚úï</button>
    <div class="auth-logo">
      <div class="auth-logo-mark">D</div>
      <div class="auth-logo-text">Draft<span>ly</span></div>
    </div>
    <div class="auth-tabs">
      <button class="auth-tab active" onclick="switchTab('login')">Log ind</button>
      <button class="auth-tab" onclick="switchTab('register')">Opret konto</button>
    </div>
    <div id="auth-message"></div>
    <div id="login-form">
      <div class="form-group"><label>E-mail</label><input type="email" id="login-email" placeholder="din@email.dk"></div>
      <div class="form-group"><label>Password</label><input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"></div>
      <button class="btn btn-primary" style="width:100%;margin-top:8px;" onclick="handleLogin()">Log ind</button>
    </div>
    <div id="register-form" class="hidden">
      <div class="form-group"><label>Brugernavn</label><input type="text" id="reg-username" placeholder="DitBrugernavn"></div>
      <div class="form-group"><label>E-mail</label><input type="email" id="reg-email" placeholder="din@email.dk"></div>
      <div class="form-group"><label>Password</label><input type="password" id="reg-password" placeholder="Min. 6 tegn"></div>
      <button class="btn btn-primary" style="width:100%;margin-top:8px;" onclick="handleRegister()">Opret konto</button>
    </div>
  </div>
</div>

<!-- App -->
<div id="app" class="hidden">
  <!-- Topbar -->
  <header class="app-topbar">
    <div class="app-logo" onclick="showPage('dashboard')">
      <div class="app-logo-mark">D</div>
      <div class="app-logo-text">Draft<span>ly</span></div>
    </div>
    <div class="app-topbar-right">
      <div class="app-chip">Runde <span class="v" id="app-round">3 / 14</span></div>
      <div class="app-chip" style="color:var(--gold);"><span class="v" id="app-budget-chip" style="color:var(--gold);">50M kr.</span></div>
      <div class="app-avatar" id="app-avatar" onclick="handleSignOut()" title="Log ud">?</div>
    </div>
  </header>

  <!-- Main scrollable area -->
  <div class="main">
    <div class="app-inner">

    <!-- OVERBLIK -->
    <div id="page-dashboard" class="page active">
      <!-- Header -->
      <div class="dash-team-header">
        <div>
          <div class="dash-team-name" id="dash-team-name">Mit Hold</div>
          <div class="dash-team-sub">S√¶son 2025/26 ¬∑ Superliga Manager</div>
          <div class="dash-deadline-tag">
            <div class="live-dot"></div>
            N√¶ste deadline: 1. marts kl. 19:30
          </div>
        </div>
      </div>

      <!-- Tiles -->
      <div class="dash-tiles">
        <div class="dash-tile dt-blue" onclick="showPage('mit-hold')">
          <div class="dash-tile-ico"><svg viewBox="0 0 44 44" fill="none" stroke="white" stroke-width="1.8" stroke-linecap="round"><path d="M22 6L28 16L40 18L31 27L33 40L22 34L11 40L13 27L4 18L16 16Z"/></svg></div>
          <div class="dash-tile-lbl">Mit Hold</div>
          <div class="dash-tile-sub">Opstilling</div>
        </div>
        <div class="dash-tile dt-teal" onclick="showPage('byg-hold')">
          <div class="dash-tile-ico"><svg viewBox="0 0 44 44" fill="none" stroke="white" stroke-width="1.8" stroke-linecap="round"><circle cx="22" cy="22" r="15"/><line x1="22" y1="10" x2="22" y2="34"/><line x1="10" y1="22" x2="34" y2="22"/></svg></div>
          <div class="dash-tile-lbl">Byg Hold</div>
          <div class="dash-tile-sub">V√¶lg spillere</div>
        </div>
        <div class="dash-tile dt-purple" onclick="showPage('rangliste')">
          <div class="dash-tile-ico"><svg viewBox="0 0 44 44" fill="none" stroke="white" stroke-width="1.8" stroke-linecap="round"><path d="M8 34L17 22L24 28L32 17L38 24"/><circle cx="8" cy="34" r="2" fill="white" stroke="none"/><circle cx="38" cy="24" r="2" fill="white" stroke="none"/></svg></div>
          <div class="dash-tile-lbl">Rangliste</div>
          <div class="dash-tile-sub">Top spillere</div>
        </div>
        <div class="dash-tile dt-pink" onclick="showPage('rangliste')">
          <div class="dash-tile-ico"><svg viewBox="0 0 44 44" fill="none" stroke="white" stroke-width="1.8" stroke-linecap="round"><path d="M8 34L22 8L36 34Z"/><line x1="12" y1="26" x2="32" y2="26"/></svg></div>
          <div class="dash-tile-lbl">Highscore</div>
          <div class="dash-tile-sub">Global rangering</div>
        </div>
        <div class="dash-tile dt-orange" onclick="showPage('ligaer')">
          <div class="dash-tile-ico"><svg viewBox="0 0 44 44" fill="none" stroke="white" stroke-width="1.8" stroke-linecap="round"><path d="M17 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="11" r="4"/><path d="M40 21v-2a4 4 0 0 0-3-3.87M28 3.13a4 4 0 0 1 0 7.75"/><path d="M26 21v-2a4 4 0 0 0-4-4h-6a4 4 0 0 0-4 4v2" stroke="none"/></svg></div>
          <div class="dash-tile-lbl">Miniligaer</div>
          <div class="dash-tile-sub">Venner</div>
        </div>
      </div>

      <!-- Main grid: pitch + stats -->
      <div class="dash-main-grid">
        <!-- Pitch -->
        <div class="dash-pitch-card">
          <div class="dash-card-hdr">
            <div class="dash-card-title">‚öΩ Min Opstilling</div>
            <span style="font-size:11px;color:var(--text-muted);" id="dash-formation-label">4-2-3-1</span>
          </div>
          <div class="dash-pitch">
            <svg class="field" viewBox="0 0 500 580" preserveAspectRatio="xMidYMid slice">
              <defs><pattern id="dpf" x="0" y="0" width="500" height="72" patternUnits="userSpaceOnUse"><rect width="500" height="36" fill="rgba(22,90,50,0.55)"/><rect y="36" width="500" height="36" fill="rgba(16,72,40,0.55)"/></pattern></defs>
              <rect width="500" height="580" fill="url(#dpf)"/>
              <rect x="18" y="14" width="464" height="552" fill="none" stroke="rgba(255,255,255,0.25)" stroke-width="1.5" rx="2"/>
              <line x1="18" y1="290" x2="482" y2="290" stroke="rgba(255,255,255,0.25)" stroke-width="1.5"/>
              <circle cx="250" cy="290" r="58" fill="none" stroke="rgba(255,255,255,0.22)" stroke-width="1.5"/>
              <circle cx="250" cy="290" r="4" fill="rgba(255,255,255,0.32)"/>
              <rect x="118" y="14" width="264" height="96" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="178" y="14" width="144" height="40" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="198" y="5" width="104" height="12" fill="none" stroke="rgba(255,255,255,0.28)" stroke-width="1.5"/>
              <rect x="118" y="470" width="264" height="96" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="178" y="526" width="144" height="40" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="198" y="563" width="104" height="12" fill="none" stroke="rgba(255,255,255,0.28)" stroke-width="1.5"/>
            </svg>
            <div id="dash-pitch-players"></div>
          </div>
        </div>

        <!-- Right column -->
        <div class="dash-right-col">
          <!-- Rank card -->
          <div class="dash-glass-card">
            <div class="dash-gc-title">Din Placering</div>
            <div class="dash-rank-big">
              <div class="dash-rank-num" id="dash-rank-big">‚Äî</div>
              <div class="dash-rank-sub" id="dash-rank-sub">Ingen rangering endnu</div>
            </div>
            <div class="dash-stat-rows">
              <div class="dash-sr"><span class="dash-sr-l">Total point</span><span class="dash-sr-v" id="dash-total-pts">0 pt.</span></div>
              <div class="dash-sr"><span class="dash-sr-l">Holdv√¶rdi</span><span class="dash-sr-v gold" id="dash-holdval">0M</span></div>
              <div class="dash-sr"><span class="dash-sr-l">Budget tilbage</span><span class="dash-sr-v up" id="dash-budget-left">50M</span></div>
            </div>
          </div>
          <!-- Mini-liga card -->
          <div class="dash-glass-card">
            <div class="dash-gc-title">Miniligaer</div>
            <div class="dash-mini-liga" id="dash-mini-liga-list">
              <div style="font-size:13px;color:var(--text-muted);text-align:center;padding:12px 0;">Ingen miniligaer endnu.<br><a onclick="showPage('ligaer')" style="color:var(--blue);cursor:pointer;">Opret eller tilmeld dig ‚Üí</a></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- MIT HOLD -->
    <div id="page-mit-hold" class="page">
      <div class="page-header">
        <div class="page-title">Mit Hold</div>
        <div class="page-sub" id="team-name-header">Indl√¶ser...</div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 280px;gap:16px;align-items:start;">
        <div>
          <div class="pitch-wrap" id="my-pitch">
            <svg class="field" viewBox="0 0 500 580" preserveAspectRatio="xMidYMid slice">
              <defs><pattern id="sf1" x="0" y="0" width="500" height="72" patternUnits="userSpaceOnUse"><rect width="500" height="36" fill="rgba(22,90,50,0.55)"/><rect y="36" width="500" height="36" fill="rgba(16,72,40,0.55)"/></pattern></defs>
              <rect width="500" height="580" fill="url(#sf1)"/>
              <rect x="18" y="14" width="464" height="552" fill="none" stroke="rgba(255,255,255,0.25)" stroke-width="1.5" rx="2"/>
              <line x1="18" y1="290" x2="482" y2="290" stroke="rgba(255,255,255,0.25)" stroke-width="1.5"/>
              <circle cx="250" cy="290" r="58" fill="none" stroke="rgba(255,255,255,0.22)" stroke-width="1.5"/>
              <circle cx="250" cy="290" r="4" fill="rgba(255,255,255,0.32)"/>
              <rect x="118" y="14" width="264" height="96" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="178" y="14" width="144" height="40" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="198" y="5" width="104" height="12" fill="none" stroke="rgba(255,255,255,0.28)" stroke-width="1.5"/>
              <rect x="118" y="470" width="264" height="96" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="178" y="526" width="144" height="40" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="198" y="563" width="104" height="12" fill="none" stroke="rgba(255,255,255,0.28)" stroke-width="1.5"/>
            </svg>
            <div id="my-pitch-players"></div>
          </div>
          <div style="margin-top:12px;">
            <div class="budget-bar-wrap"><div class="budget-bar-fill" id="my-budget-fill" style="width:0%"></div></div>
            <div class="budget-nums"><span id="my-budget-used">0 kr. brugt</span><span id="my-budget-left">50M tilbage</span></div>
          </div>
        </div>
        <div style="display:flex;flex-direction:column;gap:12px;">
          <div class="glass-md" style="padding:16px;">
            <div class="card-title">Hold Info</div>
            <div id="my-team-stats" style="display:flex;flex-direction:column;gap:8px;font-size:13px;"></div>
          </div>
          <div class="glass-md" style="padding:16px;">
            <div class="card-title">Spillere</div>
            <div id="my-player-list" style="display:flex;flex-direction:column;gap:6px;"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- BYG HOLD -->
    <div id="page-byg-hold" class="page">
      <div class="page-header">
        <div class="page-title">Byg Hold</div>
        <div class="page-sub">Klik en position p√• banen, v√¶lg derefter spiller</div>
      </div>
      <div class="byg-layout">
        <div>
          <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap;">
            <div style="flex:1;">
              <div class="card-title" style="margin-bottom:6px;">Formation</div>
              <div style="display:flex;gap:6px;">
                <button class="pos-btn active" onclick="setFormation('4231',this)">4-2-3-1</button>
                <button class="pos-btn" onclick="setFormation('433',this)">4-3-3</button>
                <button class="pos-btn" onclick="setFormation('442',this)">4-4-2</button>
              </div>
            </div>
            <button class="btn btn-primary" onclick="saveTeam()" style="align-self:flex-end;">üíæ Gem Hold</button>
          </div>
          <div class="pitch-wrap" id="tb-pitch">
            <svg class="field" viewBox="0 0 500 580" preserveAspectRatio="xMidYMid slice">
              <defs><pattern id="sf2" x="0" y="0" width="500" height="72" patternUnits="userSpaceOnUse"><rect width="500" height="36" fill="rgba(22,90,50,0.55)"/><rect y="36" width="500" height="36" fill="rgba(16,72,40,0.55)"/></pattern></defs>
              <rect width="500" height="580" fill="url(#sf2)"/>
              <rect x="18" y="14" width="464" height="552" fill="none" stroke="rgba(255,255,255,0.25)" stroke-width="1.5" rx="2"/>
              <line x1="18" y1="290" x2="482" y2="290" stroke="rgba(255,255,255,0.25)" stroke-width="1.5"/>
              <circle cx="250" cy="290" r="58" fill="none" stroke="rgba(255,255,255,0.22)" stroke-width="1.5"/>
              <circle cx="250" cy="290" r="4" fill="rgba(255,255,255,0.32)"/>
              <rect x="118" y="14" width="264" height="96" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="178" y="14" width="144" height="40" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="198" y="5" width="104" height="12" fill="none" stroke="rgba(255,255,255,0.28)" stroke-width="1.5"/>
              <rect x="118" y="470" width="264" height="96" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="178" y="526" width="144" height="40" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="1"/>
              <rect x="198" y="563" width="104" height="12" fill="none" stroke="rgba(255,255,255,0.28)" stroke-width="1.5"/>
            </svg>
            <div id="tb-slots"></div>
          </div>
          <div style="margin-top:12px;">
            <div class="budget-bar-wrap"><div class="budget-bar-fill" id="tb-budget-fill" style="width:0%"></div></div>
            <div class="budget-nums"><span id="tb-budget-used">0 kr. brugt</span><span id="tb-budget-left">50M tilbage</span></div>
          </div>
        </div>
        <div class="glass-md" style="padding:14px;">
          <div id="pool-hint" class="slot-hint">Klik en position p√• banen for at v√¶lge spiller</div>
          <div class="pool-header">
            <input class="pool-search" id="pool-search" placeholder="S√∏g spiller..." oninput="renderPool()">
            <div class="pos-btns">
              <button class="pos-btn active" data-pos="ALL" onclick="setPosFilter('ALL',this)">Alle</button>
              <button class="pos-btn" data-pos="GK" onclick="setPosFilter('GK',this)" style="color:var(--gold)">M√ÖL</button>
              <button class="pos-btn" data-pos="DEF" onclick="setPosFilter('DEF',this)" style="color:var(--teal)">DEF</button>
              <button class="pos-btn" data-pos="MID" onclick="setPosFilter('MID',this)" style="color:var(--blue)">MID</button>
              <button class="pos-btn" data-pos="ATT" onclick="setPosFilter('ATT',this)" style="color:#fb7185">ATT</button>
            </div>
          </div>
          <div class="pool-list" id="pool-list"></div>
        </div>
      </div>
    </div>

    <!-- RANGLISTE -->
    <div id="page-rangliste" class="page">
      <div class="page-header">
        <div class="page-title">Rangliste</div>
        <div class="page-sub">Global rangering ¬∑ S√¶son 2025/26</div>
      </div>
      <div class="glass-md" style="padding:18px;">
        <div id="leaderboard-list"><div class="spinner"></div></div>
      </div>
    </div>

    <!-- LIGAER -->
    <div id="page-ligaer" class="page">
      <div class="page-header">
        <div class="page-title">Miniligaer</div>
        <div class="page-sub">Spil mod dine venner</div>
      </div>
      <div class="two-actions">
        <button class="btn btn-primary" onclick="showCreateLeague()">‚ûï Opret liga</button>
        <button class="btn btn-ghost" onclick="showJoinLeague()">üîó Tilmeld med kode</button>
      </div>
      <div id="create-league-form" class="glass-md hidden" style="padding:16px;margin-bottom:16px;">
        <div class="form-group">
          <label>Liganavn</label>
          <input type="text" id="league-name-input" placeholder="f.eks. Vennekredsen 2025">
        </div>
        <button class="btn btn-primary" onclick="createLeague()">Opret liga</button>
      </div>
      <div id="join-league-form" class="glass-md hidden" style="padding:16px;margin-bottom:16px;">
        <div class="form-group">
          <label>Invitationskode</label>
          <input type="text" id="join-code-input" placeholder="ABC123" style="text-transform:uppercase;letter-spacing:2px;">
        </div>
        <button class="btn btn-primary" onclick="joinLeague()">Tilmeld</button>
      </div>
      <div id="leagues-list"><div class="spinner"></div></div>
    </div>

  </div><!-- end app-inner -->
  </div><!-- end main -->
</div><!-- end app -->

<!-- Toast -->
<div id="toast"></div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONFIG
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const SUPABASE_URL = 'https://sxwpmgkfgdgtscupslcw.supabase.co';
const SUPABASE_KEY = 'sb_publishable_OKuhz4cIyd6R9GWjqkqbdg_YtbPLTvc';
const { createClient } = supabase;
const db = createClient(SUPABASE_URL, SUPABASE_KEY);

const BUDGET = 50_000_000;
const PC = { ATT:'#fb7185', MID:'#5ab4ff', DEF:'#3dddc8', GK:'#fbbf24' };
const BC = {
  FCK:['#f5f5f5','#111'], FCM:['#cc0e1e','#fff'], FCN:['#e8171f','#fff'],
  BIF:['#f6d000','#003a8c'], AGF:['#1a3d8f','#fff'], OB:['#0047b0','#fff'],
  RFC:['#8b0000','#fff'], SIF:['#0052b0','#fff'], VFF:['#006b3c','#fff'],
  VB:['#d40000','#fff'], SF:['#e00020','#fff'], FCF:['#004daa','#fff']
};
const FORMS = {
  '4231': [
    {pos:'ATT',lbl:'ST', l:'50%',t:'14%'},
    {pos:'MID',lbl:'CAM',l:'22%',t:'27%'},{pos:'MID',lbl:'CAM',l:'50%',t:'27%'},{pos:'MID',lbl:'CAM',l:'78%',t:'27%'},
    {pos:'MID',lbl:'CDM',l:'34%',t:'43%'},{pos:'MID',lbl:'CDM',l:'66%',t:'43%'},
    {pos:'DEF',lbl:'LB', l:'9%', t:'62%'},{pos:'DEF',lbl:'CB', l:'32%',t:'62%'},{pos:'DEF',lbl:'CB', l:'68%',t:'62%'},{pos:'DEF',lbl:'RB', l:'91%',t:'62%'},
    {pos:'GK', lbl:'GK', l:'50%',t:'87%'},
  ],
  '433': [
    {pos:'ATT',lbl:'LW', l:'22%',t:'14%'},{pos:'ATT',lbl:'ST', l:'50%',t:'14%'},{pos:'ATT',lbl:'RW', l:'78%',t:'14%'},
    {pos:'MID',lbl:'CM', l:'22%',t:'43%'},{pos:'MID',lbl:'CM', l:'50%',t:'43%'},{pos:'MID',lbl:'CM', l:'78%',t:'43%'},
    {pos:'DEF',lbl:'LB', l:'9%', t:'62%'},{pos:'DEF',lbl:'CB', l:'32%',t:'62%'},{pos:'DEF',lbl:'CB', l:'68%',t:'62%'},{pos:'DEF',lbl:'RB', l:'91%',t:'62%'},
    {pos:'GK', lbl:'GK', l:'50%',t:'87%'},
  ],
  '442': [
    {pos:'ATT',lbl:'ST', l:'34%',t:'14%'},{pos:'ATT',lbl:'ST', l:'66%',t:'14%'},
    {pos:'MID',lbl:'LM', l:'9%', t:'43%'},{pos:'MID',lbl:'CM', l:'34%',t:'43%'},{pos:'MID',lbl:'CM', l:'66%',t:'43%'},{pos:'MID',lbl:'RM', l:'91%',t:'43%'},
    {pos:'DEF',lbl:'LB', l:'9%', t:'62%'},{pos:'DEF',lbl:'CB', l:'32%',t:'62%'},{pos:'DEF',lbl:'CB', l:'68%',t:'62%'},{pos:'DEF',lbl:'RB', l:'91%',t:'62%'},
    {pos:'GK', lbl:'GK', l:'50%',t:'87%'},
  ]
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let currentUser = null;
let currentProfile = null;
let currentTeam = null;
let allPlayers = [];
let tbTeam = new Array(11).fill(null);
let tbFormation = '4231';
let selSlot = null;
let posFilter = 'ALL';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function init() {
  const { data: { session } } = await db.auth.getSession();
  if (session) {
    await onLogin(session.user);
  } else {
    showLanding();
  }

  db.auth.onAuthStateChange(async (event, session) => {
    if (event === 'SIGNED_IN' && session) {
      closeModal();
      await onLogin(session.user);
    } else if (event === 'SIGNED_OUT') {
      showLanding();
    }
  });
}

function showLanding() {
  document.getElementById('loading-screen').classList.add('hidden');
  document.getElementById('app').classList.add('hidden');
  document.getElementById('landing').classList.remove('hidden');
}

function openModal(tab) {
  document.getElementById('auth-modal').classList.add('open');
  switchTab(tab || 'login');
}

function closeModal() {
  document.getElementById('auth-modal').classList.remove('open');
}

function closeModalIfBg(e) {
  if (e.target === document.getElementById('auth-modal')) closeModal();
}

async function onLogin(user) {
  currentUser = user;
  document.getElementById('landing').classList.add('hidden');
  await loadProfile();
  await loadPlayers();
  await loadTeam();
  showApp();
}

function showApp() {
  document.getElementById('loading-screen').classList.add('hidden');
  document.getElementById('app').classList.remove('hidden');
  updateSidebar();
  renderDashboard();
  renderMyTeam();
  renderBygHold();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AUTH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function switchTab(tab) {
  document.querySelectorAll('.auth-tab').forEach((t,i) => t.classList.toggle('active', (i===0&&tab==='login')||(i===1&&tab==='register')));
  document.getElementById('login-form').classList.toggle('hidden', tab !== 'login');
  document.getElementById('register-form').classList.toggle('hidden', tab !== 'register');
  document.getElementById('auth-message').innerHTML = '';
}

async function handleLogin() {
  const email = document.getElementById('login-email').value.trim();
  const password = document.getElementById('login-password').value;
  if (!email || !password) return showAuthMsg('Udfyld alle felter', 'error');
  const { error } = await db.auth.signInWithPassword({ email, password });
  if (error) showAuthMsg(error.message, 'error');
}

async function handleRegister() {
  const username = document.getElementById('reg-username').value.trim();
  const email = document.getElementById('reg-email').value.trim();
  const password = document.getElementById('reg-password').value;
  if (!username || !email || !password) return showAuthMsg('Udfyld alle felter', 'error');
  if (password.length < 6) return showAuthMsg('Password skal v√¶re mindst 6 tegn', 'error');

  const { data, error } = await db.auth.signUp({ email, password });
  if (error) return showAuthMsg(error.message, 'error');

  if (data.user) {
    await db.from('profiles').insert({ id: data.user.id, username, full_name: username });
    showAuthMsg('Konto oprettet! Tjek din e-mail for bekr√¶ftelse.', 'success');
  }
}

async function handleSignOut() {
  await db.auth.signOut();
}

function showAuthMsg(msg, type) {
  document.getElementById('auth-message').innerHTML = `<div class="auth-${type}">${msg}</div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATA LOADING
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadProfile() {
  const { data } = await db.from('profiles').select('*').eq('id', currentUser.id).single();
  currentProfile = data;
}

async function loadPlayers() {
  const { data } = await db.from('players').select('*').eq('active', true).order('total_points', { ascending: false });
  allPlayers = data || [];
}

async function loadTeam() {
  const { data } = await db.from('teams')
    .select('*, team_players(*, players(*))')
    .eq('user_id', currentUser.id)
    .single();

  if (data) {
    currentTeam = data;
    tbFormation = data.formation || '4231';
    // Populate tbTeam from DB
    tbTeam = new Array(11).fill(null);
    if (data.team_players) {
      data.team_players.forEach(tp => {
        if (tp.slot_index >= 0 && tp.slot_index < 11) {
          tbTeam[tp.slot_index] = { ...tp.players, is_captain: tp.is_captain };
        }
      });
    }
  } else {
    currentTeam = null;
    tbTeam = new Array(11).fill(null);
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAVIGATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showPage(id) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + id).classList.add('active');
  if (id === 'rangliste') loadLeaderboard();
  if (id === 'ligaer') loadLeagues();
  if (id === 'mit-hold') renderMyTeam();
  if (id === 'byg-hold') renderBygHold();
}

function updateSidebar() {
  const name = currentProfile?.username || currentUser?.email?.split('@')[0] || '?';
  const avatarEl = document.getElementById('app-avatar');
  if (avatarEl) {
    avatarEl.textContent = name[0].toUpperCase();
    avatarEl.title = name + ' ‚Äî klik for at logge ud';
  }
  // Update budget chip
  const budget = currentTeam?.budget_remaining ?? BUDGET;
  const budgetChip = document.getElementById('app-budget-chip');
  if (budgetChip) budgetChip.textContent = (budget / 1e6).toFixed(2) + 'M kr.';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DASHBOARD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderDashboard() {
  const totalPts = currentTeam?.total_points || 0;
  const val = tbTeam.reduce((s, p) => s + (p ? p.price * 1e6 : 0), 0);
  const budget = currentTeam?.budget_remaining ?? BUDGET;
  const username = currentProfile?.username || 'Mit Hold';

  // Update team name header
  const nameEl = document.getElementById('dash-team-name');
  if (nameEl) nameEl.textContent = username + 's Hold';

  // Update stats cards
  const rankEl = document.getElementById('dash-rank-big');
  if (rankEl) rankEl.textContent = '‚Äî';
  const rankSubEl = document.getElementById('dash-rank-sub');
  if (rankSubEl) rankSubEl.textContent = 'Ingen rangering endnu';
  const totalPtsEl = document.getElementById('dash-total-pts');
  if (totalPtsEl) totalPtsEl.textContent = totalPts + ' pt.';
  const holdValEl = document.getElementById('dash-holdval');
  if (holdValEl) holdValEl.textContent = Math.round(val / 1e6) + 'M';
  const budgetLeftEl = document.getElementById('dash-budget-left');
  if (budgetLeftEl) budgetLeftEl.textContent = Math.round(budget / 1e6) + 'M';

  // Update topbar budget chip
  const budgetChip = document.getElementById('app-budget-chip');
  if (budgetChip) budgetChip.textContent = (budget / 1e6).toFixed(2) + 'M kr.';

  // Formation label
  const formEl = document.getElementById('dash-formation-label');
  if (formEl) formEl.textContent = tbFormation.replace('4231','4-2-3-1').replace('433','4-3-3').replace('442','4-4-2');

  // Render mini pitch
  renderDashPitch();

  // Load mini-liga leaderboard
  renderDashMiniLiga();
}

function renderDashPitch() {
  const slots = FORMS[tbFormation];
  const container = document.getElementById('dash-pitch-players');
  if (!container) return;
  container.innerHTML = '';

  slots.forEach((s, i) => {
    const p = tbTeam[i];
    const div = document.createElement('div');
    div.className = 'dash-pd';
    div.style.cssText = `position:absolute;left:${s.l};top:${s.t};transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;gap:4px;z-index:10;`;
    if (p) {
      const [bg, fg] = BC[p.club] || ['#444','#fff'];
      div.innerHTML = `
        <div class="dash-p-badge" style="background:${bg};color:${fg};">
          <div class="dash-p-badge-abbr">${p.club}</div>
        </div>
        <div class="dash-pd-name">${p.name.split(' ').pop()}</div>`;
    } else {
      div.innerHTML = `<div class="dash-empty-badge" style="border-color:${PC[s.pos]}40;">
        <span style="font-size:9px;font-weight:700;color:${PC[s.pos]};opacity:.6;">${s.lbl}</span>
      </div>`;
    }
    container.appendChild(div);
  });
}

async function renderDashMiniLiga() {
  const container = document.getElementById('dash-mini-liga-list');
  if (!container) return;
  const { data: memberships } = await db.from('league_members')
    .select('*, leagues(*)')
    .eq('user_id', currentUser.id)
    .limit(2);

  if (!memberships || memberships.length === 0) {
    container.innerHTML = `<div style="font-size:13px;color:var(--text-muted);text-align:center;padding:12px 0;">Ingen miniligaer endnu.<br><a onclick="showPage('ligaer')" style="color:var(--blue);cursor:pointer;">Opret eller tilmeld dig ‚Üí</a></div>`;
    return;
  }
  container.innerHTML = '';
  for (const m of memberships) {
    const row = document.createElement('div');
    row.className = 'dash-ml-row me';
    row.innerHTML = `<span class="dash-ml-rank">#‚Äî</span><span class="dash-ml-name">${m.leagues?.name || 'Liga'}</span><span class="dash-ml-pts">‚Äî</span>`;
    container.appendChild(row);
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MIT HOLD (read-only pitch view)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderMyTeam() {
  const slots = FORMS[tbFormation];
  const container = document.getElementById('my-pitch-players');
  container.innerHTML = '';

  slots.forEach((s, i) => {
    const p = tbTeam[i];
    const div = document.createElement('div');
    div.className = 'pd';
    div.style.cssText = `left:${s.l};top:${s.t};`;
    if (p) {
      const [bg, fg] = BC[p.club] || ['#444','#fff'];
      div.innerHTML = `
        <div class="p-badge" style="background:${bg};color:${fg};">
          <div class="p-badge-abbr">${p.club}</div>
          ${p.is_captain ? '<div class="chip-cap">K</div>' : ''}
        </div>
        <div class="pd-name">${p.name.split(' ').pop()}</div>
        <div class="pd-pts">${p.total_points}p</div>`;
    } else {
      div.innerHTML = `<div class="p-badge" style="background:rgba(255,255,255,0.08);color:${PC[s.pos]};border:2px dashed ${PC[s.pos]}40;">
        <div class="p-badge-abbr" style="font-size:9px;">${s.lbl}</div></div>`;
    }
    container.appendChild(div);
  });

  // Team name
  document.getElementById('team-name-header').textContent = currentTeam?.name || 'Intet hold endnu ‚Äî g√• til Byg Hold';

  // Budget
  const used = tbTeam.reduce((s,p) => s + (p ? p.price*1e6 : 0), 0);
  const left = BUDGET - used;
  const pct = Math.min(100, (used/BUDGET)*100);
  document.getElementById('my-budget-fill').style.width = pct + '%';
  document.getElementById('my-budget-used').textContent = (used/1e6).toFixed(1) + 'M brugt';
  document.getElementById('my-budget-left').textContent = (left/1e6).toFixed(1) + 'M tilbage';

  // Stats
  const players = tbTeam.filter(Boolean);
  document.getElementById('my-team-stats').innerHTML = `
    <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted)">Spillere</span><span>${players.length}/11</span></div>
    <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted)">Holdv√¶rdi</span><span style="color:var(--teal)">${(used/1e6).toFixed(1)}M</span></div>
    <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted)">Formation</span><span>${tbFormation}</span></div>
    <div style="display:flex;justify-content:space-between;"><span style="color:var(--text-muted)">Total point</span><span style="color:var(--gold)">${currentTeam?.total_points || 0}</span></div>`;

  // Player list
  document.getElementById('my-player-list').innerHTML = players.map(p => {
    const [bg,fg] = BC[p.club] || ['#444','#fff'];
    return `<div style="display:flex;align-items:center;gap:8px;padding:6px 8px;border-radius:8px;background:var(--glass);">
      <div style="width:26px;height:26px;border-radius:50%;background:${bg};color:${fg};display:flex;align-items:center;justify-content:center;font-size:8px;font-weight:900;font-family:var(--font-display);flex-shrink:0;">${p.club}</div>
      <div style="flex:1;font-size:12px;font-weight:600;">${p.name}</div>
      <div style="font-size:11px;color:${PC[p.position]};font-weight:700;">${p.position}</div>
      <div style="font-size:11px;color:var(--teal);font-weight:700;">${p.total_points}p</div>
    </div>`;
  }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BYG HOLD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderBygHold() {
  renderTbSlots();
  renderPool();
  updateTbBudget();
}

function setFormation(f, btn) {
  tbFormation = f;
  document.querySelectorAll('#page-byg-hold .pos-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  selSlot = null;
  renderTbSlots();
  renderPool();
}

function renderTbSlots() {
  const slots = FORMS[tbFormation];
  const container = document.getElementById('tb-slots');
  container.innerHTML = '';
  slots.forEach((s, i) => {
    const p = tbTeam[i];
    const div = document.createElement('div');
    div.className = 'pd';
    div.style.cssText = `left:${s.l};top:${s.t};`;
    if (p) {
      const [bg, fg] = BC[p.club] || ['#444','#fff'];
      div.innerHTML = `
        <div class="p-badge" style="background:${bg};color:${fg};box-shadow:0 4px 16px rgba(0,0,0,.5);">
          <div class="p-badge-abbr">${p.club}</div>
          <div class="chip-cap" style="cursor:pointer;" onclick="event.stopPropagation();removePlayer(${i})">‚úï</div>
        </div>
        <div class="pd-name">${p.name.split(' ').pop()}</div>
        <div class="pd-pts">${(p.price).toFixed(1)}M</div>`;
    } else {
      const isSelected = selSlot === i;
      div.innerHTML = `<div class="p-badge" style="background:${isSelected ? 'rgba(59,130,246,0.3)' : 'rgba(255,255,255,0.08)'};color:${PC[s.pos]};border:2px dashed ${isSelected ? 'var(--blue)' : PC[s.pos]+'60'};">
        <div class="p-badge-abbr" style="font-size:9px;">${s.lbl}</div></div>
        <div class="pd-name" style="color:${PC[s.pos]};background:transparent;border:none;">${s.pos}</div>`;
    }
    div.onclick = () => clickSlot(i);
    container.appendChild(div);
  });
}

function clickSlot(i) {
  selSlot = i;
  const pos = FORMS[tbFormation][i].pos;
  posFilter = pos;
  document.querySelectorAll('#page-byg-hold .pos-btns .pos-btn').forEach(b => b.classList.toggle('active', b.dataset.pos === pos));
  const hint = document.getElementById('pool-hint');
  hint.textContent = `V√¶lger ${FORMS[tbFormation][i].lbl}-position ¬∑ Kun ${pos} spillere`;
  hint.classList.add('selecting');
  renderTbSlots();
  renderPool();
}

function removePlayer(i) {
  tbTeam[i] = null;
  if (selSlot === i) selSlot = null;
  renderTbSlots();
  renderPool();
  updateTbBudget();
}

function selectPlayer(id) {
  if (selSlot === null) return toast('Klik f√∏rst en position p√• banen', 'error');
  const p = allPlayers.find(x => x.id === id);
  if (!p) return;
  const slotPos = FORMS[tbFormation][selSlot].pos;
  if (p.position !== slotPos) return toast(`Denne position kr√¶ver en ${slotPos}`, 'error');
  const used = tbTeam.reduce((s,x) => s + (x ? x.price*1e6 : 0), 0);
  const has = tbTeam[selSlot] ? tbTeam[selSlot].price*1e6 : 0;
  if (p.price*1e6 > BUDGET - used + has) return toast('Ikke nok budget', 'error');
  tbTeam[selSlot] = p;
  selSlot = null;
  document.getElementById('pool-hint').textContent = 'Klik en position p√• banen for at v√¶lge spiller';
  document.getElementById('pool-hint').classList.remove('selecting');
  posFilter = 'ALL';
  document.querySelectorAll('#page-byg-hold .pos-btns .pos-btn').forEach(b => b.classList.toggle('active', b.dataset.pos === 'ALL'));
  renderTbSlots();
  renderPool();
  updateTbBudget();
}

function setPosFilter(pos, btn) {
  if (selSlot !== null) return; // Don't change filter when slot is selected
  posFilter = pos;
  document.querySelectorAll('#page-byg-hold .pos-btns .pos-btn').forEach(b => b.classList.toggle('active', b.dataset.pos === pos));
  renderPool();
}

function renderPool() {
  const search = document.getElementById('pool-search').value.toLowerCase();
  const inTeam = new Set(tbTeam.filter(Boolean).map(p => p.id));
  const used = tbTeam.reduce((s,x) => s + (x ? x.price*1e6 : 0), 0);
  const budget = BUDGET - used + (selSlot !== null && tbTeam[selSlot] ? tbTeam[selSlot].price*1e6 : 0);
  const requiredPos = selSlot !== null ? FORMS[tbFormation][selSlot].pos : null;
  const list = document.getElementById('pool-list');
  list.innerHTML = '';

  allPlayers.forEach(p => {
    if (requiredPos && p.position !== requiredPos) return;
    if (!requiredPos && posFilter !== 'ALL' && p.position !== posFilter) return;
    if (search && !p.name.toLowerCase().includes(search) && !p.club.toLowerCase().includes(search)) return;

    const cantAfford = p.price*1e6 > budget;
    const row = document.createElement('div');
    row.className = 'pool-row' + (inTeam.has(p.id) ? ' in-team' : cantAfford ? ' cant-afford' : '');
    const [bg, fg] = BC[p.club] || ['#444','#fff'];
    row.innerHTML = `
      <div class="pr-badge" style="background:${bg};color:${fg};">${p.club}</div>
      <div class="pr-info"><div class="pr-name">${p.name}</div><div class="pr-club">${p.club}</div></div>
      <div class="pr-pos" style="color:${PC[p.position]}">${p.position}</div>
      <div style="text-align:right;">
        <div class="pr-price">${p.price.toFixed(1)}M</div>
        <div class="pr-pts">${p.total_points}p</div>
      </div>`;
    row.onclick = () => selectPlayer(p.id);
    list.appendChild(row);
  });
}

function updateTbBudget() {
  const used = tbTeam.reduce((s,p) => s + (p ? p.price*1e6 : 0), 0);
  const left = BUDGET - used;
  const pct = Math.min(100, (used/BUDGET)*100);
  document.getElementById('tb-budget-fill').style.width = pct + '%';
  document.getElementById('tb-budget-fill').style.background = pct > 95 ? 'linear-gradient(90deg,#ef4444,#f97316)' : 'linear-gradient(90deg,var(--teal),var(--blue))';
  document.getElementById('tb-budget-used').textContent = (used/1e6).toFixed(1) + 'M brugt';
  document.getElementById('tb-budget-left').textContent = (left/1e6).toFixed(1) + 'M tilbage';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SAVE TEAM
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function saveTeam() {
  const filled = tbTeam.filter(Boolean).length;
  if (filled < 11) return toast(`Udfyld alle 11 positioner (${filled}/11)`, 'error');

  const used = tbTeam.reduce((s,p) => s + (p ? p.price*1e6 : 0), 0);
  const budget_remaining = BUDGET - used;
  const teamName = currentProfile?.username + "'s Hold" || 'Mit Hold';

  let teamId;
  if (currentTeam) {
    // Update existing
    await db.from('teams').update({ formation: tbFormation, budget_remaining }).eq('id', currentTeam.id);
    await db.from('team_players').delete().eq('team_id', currentTeam.id);
    teamId = currentTeam.id;
  } else {
    // Create new
    const { data } = await db.from('teams').insert({ user_id: currentUser.id, name: teamName, formation: tbFormation, budget_remaining }).select().single();
    teamId = data.id;
  }

  // Insert team players
  const inserts = tbTeam.map((p, i) => ({ team_id: teamId, player_id: p.id, slot_index: i, is_captain: i === 0 }));
  await db.from('team_players').insert(inserts);

  await loadTeam();
  renderMyTeam();
  toast('Hold gemt! ‚úÖ', 'success');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RANGLISTE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadLeaderboard() {
  const { data } = await db.from('teams')
    .select('id, name, total_points, user_id, profiles(username)')
    .order('total_points', { ascending: false })
    .limit(50);

  const el = document.getElementById('leaderboard-list');
  if (!data || data.length === 0) {
    el.innerHTML = '<div style="text-align:center;color:var(--text-muted);padding:40px;">Ingen hold endnu ‚Äî v√¶r den f√∏rste!</div>';
    return;
  }
  el.innerHTML = data.map((t, i) => {
    const isMe = t.user_id === currentUser.id;
    return `<div class="lb-row ${isMe ? 'me' : ''}">
      <div class="lb-rank ${i < 3 ? 'top3' : ''}">${i < 3 ? ['ü•á','ü•à','ü•â'][i] : i+1}</div>
      <div class="lb-info">
        <div class="lb-name">${t.profiles?.username || 'Anonym'}</div>
        <div class="lb-team">${t.name}</div>
      </div>
      <div class="lb-pts">${t.total_points}</div>
    </div>`;
  }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// LIGAER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showCreateLeague() {
  document.getElementById('create-league-form').classList.toggle('hidden');
  document.getElementById('join-league-form').classList.add('hidden');
}
function showJoinLeague() {
  document.getElementById('join-league-form').classList.toggle('hidden');
  document.getElementById('create-league-form').classList.add('hidden');
}

async function createLeague() {
  if (!currentTeam) return toast('Du skal have et hold for at oprette en liga', 'error');
  const name = document.getElementById('league-name-input').value.trim();
  if (!name) return toast('Skriv et liganavn', 'error');
  const code = Math.random().toString(36).substring(2,8).toUpperCase();
  const { data, error } = await db.from('leagues').insert({ name, code, created_by: currentUser.id }).select().single();
  if (error) return toast('Fejl: ' + error.message, 'error');
  await db.from('league_members').insert({ league_id: data.id, team_id: currentTeam.id });
  document.getElementById('league-name-input').value = '';
  document.getElementById('create-league-form').classList.add('hidden');
  toast('Liga oprettet! Kode: ' + code, 'success');
  loadLeagues();
}

async function joinLeague() {
  if (!currentTeam) return toast('Du skal have et hold for at tilmelde dig en liga', 'error');
  const code = document.getElementById('join-code-input').value.trim().toUpperCase();
  if (!code) return toast('Indtast en kode', 'error');
  const { data: league, error } = await db.from('leagues').select('*').eq('code', code).single();
  if (error || !league) return toast('Ingen liga fundet med den kode', 'error');
  const { error: joinError } = await db.from('league_members').insert({ league_id: league.id, team_id: currentTeam.id });
  if (joinError) return toast('Du er allerede med i denne liga', 'error');
  document.getElementById('join-code-input').value = '';
  document.getElementById('join-league-form').classList.add('hidden');
  toast('Tilmeldt ' + league.name + '! ‚úÖ', 'success');
  loadLeagues();
}

async function loadLeagues() {
  if (!currentTeam) {
    document.getElementById('leagues-list').innerHTML = '<div style="color:var(--text-muted);font-size:13px;padding:16px;">Du skal bygge et hold for at deltage i miniligaer.</div>';
    return;
  }
  const { data } = await db.from('league_members')
    .select('leagues(id, name, code), league_id')
    .eq('team_id', currentTeam.id);

  const el = document.getElementById('leagues-list');
  if (!data || data.length === 0) {
    el.innerHTML = '<div style="color:var(--text-muted);font-size:13px;padding:16px;text-align:center;">Du er ikke med i nogen ligaer endnu.<br>Opret en ny eller tilmeld dig med en kode.</div>';
    return;
  }
  el.innerHTML = data.map(m => `
    <div class="league-card glass">
      <div class="league-icon">üèÜ</div>
      <div class="league-info">
        <div class="league-name">${m.leagues.name}</div>
        <div class="league-meta">Kode: <span class="code-display" style="display:inline;padding:2px 8px;font-size:13px;" onclick="copyCode('${m.leagues.code}')">${m.leagues.code}</span></div>
      </div>
    </div>`).join('');
}

function copyCode(code) {
  navigator.clipboard.writeText(code);
  toast('Kode kopieret: ' + code, 'success');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TOAST
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let toastTimer;
function toast(msg, type = 'success') {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.className = 'show ' + type;
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => el.classList.remove('show'), 3000);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// START
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
init();
</script>
</body>
</html>
